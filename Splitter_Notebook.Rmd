---
title: "Notice Splitter"
author: "Josh Greer"
date: "07/06/2020"
output:
  html_document:
    df_print: paged
---

```{r,echo=False}
library(stringr)
library(purrr)
library(magrittr)
library(tidyr)
library(dplyr)
```

# Import Data

```{r}
file_path <- "./SampleText/Input_Text_Sample.txt"
data <- read.table(file_path, header = FALSE, sep = "\n", quote = "")
data['const_key']=1
num_files = as.integer(readline(prompt='Enter Number of Files Required:'))
```

# Create Group Key

```{r}
rows = nrow(data)
for(i in 2:rows)
{ 
  if (str_detect(data[i,'V1'],'GROUP')==TRUE){
    data[i,'const_key'] = data[i-1,'const_key']+1
  }else{
    data[i,'const_key'] = data[i-1,'const_key']
  }
}
```

# Summarize Records

```{r}
new_data = data.frame()
r = max(data['const_key'])
for(i in 1:r)
{
  set1= filter(data,data['const_key']==i)
  d = paste(unlist(set1$V1), collapse ="\n")
  df = cbind(i,d)
  new_data = rbind(new_data,df)
}
```

# get the number of file splits

```{r}
total_rows = nrow(new_data)
file_records = 0

remainder = total_rows%%num_files
if (remainder==0) {
  file_records = floor(total_rows/num_files)
} else {
  file_records = floor(total_rows/(num_files-1))
  }
for (j in 1:total_rows)
  {new_data[j,'i'] = ceiling(as.integer(new_data[j,'i'])/file_records)}
```

#Write the files

```{r}
for (a in 1:total_rows)
  {new_data[a,'index'] = as.integer(new_data[a,'i'])}
n_file = max(new_data['index'])
for (k in 1:n_file)
{
  df1 = filter(new_data, new_data['index']==k)
  df2 = df1['d']
  write.table(df2, file = paste('File_',as.character(k),'.txt'), sep = '',row.names = FALSE , col.names = FALSE, quote = FALSE  )
    }

```
